
/****************************************************************************************************
* File cc_clock.c Start!
****************************************************************************************************/

/****************************************************************************************************
* Include
****************************************************************************************************/
#include "cc_clock.h"
#include "cc_trace.h"

/****************************************************************************************************
* Define
****************************************************************************************************/

/****************************************************************************************************
* Type Define
****************************************************************************************************/

/****************************************************************************************************
* Global Variable
****************************************************************************************************/

/* clock */
cc_clock_struct cc_clock_t;
/* init flag */
cc_boolean cc_clock_initflag = CC_FALSE;

/****************************************************************************************************
* Function Impletement
****************************************************************************************************/

/****************************************************************************************************
* cc_clock_init()
****************************************************************************************************/
cc_result cc_clock_init(cc_void)
{
    cc_result result = CC_E_OK;

    do
    {
        /* check parameter */
        CHECK_LOGIC(result,(cc_clock_initflag != CC_TRUE));

        /* init value */
        cc_clock_t.tick = 0;
        cc_clock_t.callback = CC_NULL_PTR;

        /* init flag */
        cc_clock_initflag = CC_TRUE;
    }while(0u);

    return result;
}

/****************************************************************************************************
* cc_clock_tickincrease()
****************************************************************************************************/
cc_result cc_clock_tickincrease(cc_void)
{
    cc_result result = CC_E_OK;

    do
    {
        /* check parameter */
        CHECK_LOGIC(result,(cc_clock_initflag == CC_TRUE));
        /* init value */
        cc_clock_t.tick++;
        /* if callback != NULL_PTR */
        CHECK_PTR(result,cc_clock_t.callback);
        cc_clock_t.callback();
    }while(0u);

    return result;
}

/****************************************************************************************************
* cc_clock_tick_callback_init()
****************************************************************************************************/
cc_result cc_clock_tick_callback_init(cc_void *func)
{
    cc_result result = CC_E_OK;

    do
    {
        /* check parameter */
        CHECK_PTR(result,func);
        CHECK_LOGIC(result,(cc_clock_initflag == CC_TRUE));

        /* init value */
        cc_clock_t.callback = func;
    }while(0u);

    return result;
}

/****************************************************************************************************
* cc_clock_tickget()
****************************************************************************************************/
cc_result cc_clock_tickget(cc_uint64 *tick)
{
    cc_result result = CC_E_OK;

    do
    {
        /* check parameter */
        CHECK_PTR(result,tick);
        CHECK_LOGIC(result,(cc_clock_initflag == CC_TRUE));
        /* init value */
        *tick = cc_clock_t.tick;
    }while(0u);

    return result;
}

/****************************************************************************************************
* cc_clock_tickgetdirect()
****************************************************************************************************/
cc_uint64 cc_clock_tickgetdirect(cc_void)
{
    return cc_clock_t.tick;
}

/****************************************************************************************************
* File cc_clock.c End!
****************************************************************************************************/

